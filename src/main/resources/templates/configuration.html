<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<title th:text="${@environment.getProperty('application_name')}"></title>
</head>
<body>
	<div th:replace="base::css-core"></div>
	<div id="wrapper">
		<div th:replace="layout-dashboard :: navbar"></div>
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<div th:replace="layout-dashboard :: switch-user"></div>
					<div id="content">
						<section>
							<div th:if="${configuration!=null}">
								<h1 class="page-header" th:if="${action=='edit'}"
									th:text="${#messages.msg('label.configuration.title.edit')}">
								</h1>
								<h1 class="page-header" th:if="${action=='add'}"
									th:text="${#messages.msg('label.configuration.title.add')}"></h1>
								<h1 class="page-header" th:if="${action=='view'}"
									th:text="${#messages.msg('label.configuration.title')}"></h1>
								<div th:if="${alertSuccess}" class="alert alert-success fade in">
									<a href="#" class="close" data-dismiss="alert">&times;</a><span
										th:text="${alertSuccess}">Success message.</span>
								</div>
								<div th:if="${alertWarning}" class="alert alert-warning fade in">
									<a href="#" class="close" data-dismiss="alert">&times;</a><span
										th:text="${alertWarning}">Warning message.</span>
								</div>


								<form id="form" action="#" th:action="@{/configuration}"
									th:object="${configuration}" method="POST">
									<div th:if="${result!=null AND result.hasErrors()}"
										class="alert alert-warning fade in">
										<ul>
											<li th:each="err : ${result.allErrors}"
												th:text="${err.defaultMessage}">Input is incorrect</li>
										</ul>
									</div>
									<table class="table">
										<thead>
											<tr>
												<th class="col-sm-3">Key</th>
												<th class="col-sm-7">Value</th>
											</tr>
										</thead>
										<tbody th:if="${action!='edit' and action!='add'}">
											<tr>
												<td
													th:text="${#messages.msg('label.configuration.docstoreRelation')}">Docstore
													Relation</td>
												<td>
													<div id="docrelationdiv">
														<table id="docrelation-tbl" class="table table-compact">
															<thead>
																<tr>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationPrincipal')}"></th>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationType')}"></th>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationParty')}">
																	</th>
																</tr>
															</thead>
															<tbody>
																<tr>
																	<td
																		th:text="${configuration.principalDocstore.reference}">docstoreRelationPrincipal</td>
																	<td th:text="*{docstoreRelationType}">docstoreRelationType</td>
																	<td th:text="${configuration.partyDocstore.reference}">docstoreRelationParty</td>
																</tr>
															</tbody>
														</table>
													</div>
												</td>
											</tr>
										</tbody>
										<tbody th:if="${action=='edit' or action=='add'}">
											<tr>
												<td
													th:text="${#messages.msg('label.configuration.docstoreRelation')}">Docstore
													Relation</td>
												<td>
													<div id="docrelationdiv">
														<table id="docrelation-tbl" class="table table-compact">
															<thead>
																<tr>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationPrincipal')}"></th>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationType')}"></th>
																	<th
																		th:text="${#messages.msg('label.configuration.docstoreRelationParty')}">
																	</th>
																</tr>
															</thead>
															<tbody>
																<tr
																	th:if="${action=='add' or #strings.isEmpty(configuration.docstoreRelationUuid)}">
																	<td><select id="docstoreRelationPrincipal"
																		name="docstoreRelationPrincipal" class="form-control"
																		th:field="*{docstoreRelationPrincipal}">
																			<option th:each="docstore : ${docstoreList}"
																				th:value="${docstore.uuid}"
																				th:text="${docstore?.reference}"></option>
																	</select></td>
																	<td><select id="docstoreRelationType"
																		name="docstoreRelationType" class="form-control"
																		th:field="*{docstoreRelationType}">
																			<option th:each="type : ${docstoreRelationTypes}"
																				th:value="${type}" th:text="${type}"></option>
																	</select></td>
																	<td><select id="docstoreRelationParty"
																		name="docstoreRelationParty" class="form-control"
																		th:field="*{docstoreRelationParty}">
																			<option th:each="docstore : ${docstoreList}"
																				th:value="${docstore.uuid}"
																				th:text="${docstore?.reference}"></option>
																	</select></td>
																</tr>
																<tr
																	th:unless="${action=='add' or #strings.isEmpty(configuration.docstoreRelationUuid)}">
																	<td
																		th:text="${configuration.principalDocstore?.reference}">docstoreRelationPrincipal</td>
																	<td th:text="*{docstoreRelationType}">docstoreRelationType</td>
																	<td th:text="${configuration.partyDocstore?.reference}">docstoreRelationParty</td>
																</tr>
															</tbody>
														</table>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
									<input type="hidden" th:name="action" th:field="*{action}" />
									<input type="hidden" th:name="docstoreRelationUuid"
										th:field="*{docstoreRelationUuid}" /> <input type="hidden"
										th:name="uuid"
										th:value="${configuration.docstoreRelationUuid}" /> <input
										type="hidden" th:name="${_csrf.parameterName}"
										th:value="${_csrf.token}" /> <a
										th:if="${action!='edit' and action!='add'}"
										th:href="@{/configurations/__${configuration.docstoreRelationUuid}__/edit}"
										class="btn btn-sm btn-warning"
										th:text="${#messages.msg('label.button.edit')}">Edit</a>
									<button th:if="${action=='edit' or action=='add'}"
										class="btn btn-sm btn-success" type="submit"
										th:text="${#messages.msg('label.button.save')}">Save</button>
									<a th:if="${action=='edit'}"
										th:href="@{/configurations/__${configuration.docstoreRelationUuid}__/edit}"
										class="btn btn-sm btn-warning"
										th:text="${#messages.msg('label.button.reset')}">Reset</a>
								</form>
							</div>

							<div th:if="${configuration==null AND action!='edit'}">
								<span
									th:text="${#messages.msg('label.configuration.warning.isEmpty')}">Warning
									Configuration is empty.</span>
							</div>
						</section>
					</div>
				</div>
			</div>
		</div>

	</div>
	<!-- /#wrapper -->
	<div th:replace="base::js-core"></div>
	<script type="text/javascript">
		//<![CDATA[
		jQuery(document).ready(function() {
			jQuery("span.timeago").timeago();
			setT
			imeout(function() {
				$(".alert").alert('close');
			}, 8000);
		});
		//]]>
	</script>
</body>
</html>

