<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<title th:text="${@environment.getProperty('application_name')}"></title>
</head>
<body>
	<div th:replace="base::css-core"></div>
	<div id="wrapper">
		<div th:replace="layout-dashboard :: navbar"></div>
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<div th:replace="layout-dashboard :: switch-user"></div>
					<div id="content">
						<section>
							<h1 class="page-header" th:unless="${usermanagement}"
								th:text="${#messages.msg('label.userprofile.title')}"></h1>
							<h1 class="page-header"
								th:if="${usermanagement and action=='edit'}"
								th:text="${#messages.msg('label.usermanagement.title.edit')}">
							</h1>
							<h1 class="page-header"
								th:if="${usermanagement and action=='add'}"
								th:text="${#messages.msg('label.usermanagement.title.add')}"></h1>
							<h1 class="page-header"
								th:if="${usermanagement and action=='view'}"
								th:text="${#messages.msg('label.usermanagement.title')}"></h1>
							<div th:if="${alertSuccess}" class="alert alert-success fade in">
								<a href="#" class="close" data-dismiss="alert">&times;</a><span
									th:utext="${alertSuccess}">Success message.</span>
							</div>
							<div th:if="${alertWarning}" class="alert alert-warning fade in">
								<a href="#" class="close" data-dismiss="alert">&times;</a><span
									th:text="${alertWarning}">Warning message.</span>
							</div>
							<div class="error-info"></div>
							<form th:if="${user!=null}" id="form" action="#"
								th:action="@{/user}" th:object="${user}" method="POST">
								<div th:if="${result!=null AND result.hasErrors()}"
									class="alert alert-warning fade in">
									<ul>
										<li th:each="err : ${result.allErrors}"
											th:text="${err.defaultMessage}">Input is incorrect</li>
									</ul>
								</div>
								<table class="table">
									<thead>
										<tr>
											<th class="col-sm-4"><span
												th:text="${#messages.msg('label.key')}">Key</span></th>
											<th class="col-sm-6"><span
												th:text="${#messages.msg('label.value')}">Value</span></th>
										</tr>
									</thead>
									<tbody th:if="${action=='view'}">
										<tr>
											<td th:text="${#messages.msg('label.userprofile.username')}">Username</td>
											<td th:text="*{username}">username</td>
										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.fullName')}">Full
												Name</td>
											<td th:text="*{fullName}">full name</td>
										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.jobTitle')}">Job
												Title</td>
											<td th:text="*{jobTitle}">job title</td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.mobileNumber')}">Mobile
												Number</td>
											<td th:text="*{mobileNumber}">mobile number</td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.emailAddress')}">Email
												Address</td>
											<td th:text="*{emailAddress}">email address</td>
										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.userRole')}">User
												Role</td>
											<td th:text="*{userRoleList}">user role</td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.userdocstorelink')}">User
												Docstore Link</td>
											<td th:text="*{userDocstoreList}">docstore</td>
										</tr>
									</tbody>
									<tbody th:if="${action=='edit' or action=='add'}">
										<tr>
											<td th:text="${#messages.msg('label.userprofile.username')}">Username</td>
											<td th:if="${action=='edit'}"><input type="hidden"
												th:name="username" th:field="*{username}" /> <input
												type="text" th:field="*{username}" class="form-control"
												th:disabled="true" /></td>
											<td th:if="${action=='add'}"><input type="text"
												th:name="username" th:field="*{username}"
												class="form-control" /></td>

										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.fullName')}">Full
												Name</td>
											<td><input type="text" th:field="*{fullName}"
												class="form-control" /></td>
										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.jobTitle')}">Job
												Title</td>
											<td><input type="text" th:field="*{jobTitle}"
												class="form-control" /></td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.mobileNumber')}">Mobile
												Number</td>
											<td><input type="text" th:field="*{mobileNumber}"
												class="form-control" /></td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.emailAddress')}">Email
												Address</td>
											<td><input type="text" th:field="*{emailAddress}"
												class="form-control" /></td>
										</tr>
										<tr>
											<td th:text="${#messages.msg('label.userprofile.userRole')}">User
												Role</td>
											<td><select id="roleNames" name="roleNames"
												class="form-control" multiple="multiple"
												th:field="*{roleNames}">
													<option th:each="role : ${roleList}"
														th:value="${role.id.name}" th:text="${role.id.name}"></option>
											</select></td>
										</tr>
										<tr>
											<td
												th:text="${#messages.msg('label.userprofile.userdocstorelink')}">User
												Docstore Link</td>
											<td><select id="docstores" name="docstore"
												class="form-control" multiple="multiple"
												th:field="*{docstores}">
													<option th:each="docstore : ${docstoreList}"
														th:value="${docstore.uuid}"
														th:text="${docstore.reference}"></option>
											</select></td>
										</tr>
									</tbody>
								</table>
								<input type="hidden" th:name="action" th:field="*{action}" /> <input
									th:if="${action!='add'}" type="hidden" th:name="roleNames"
									th:field="*{roleNames}" /> <input type="hidden" th:name="uuid"
									th:field="*{uuid}" /><input
									type="hidden" th:name="${_csrf.parameterName}"
									th:value="${_csrf.token}" /> <a
									th:if="${action!='edit' and action!='add'}"
									th:href="@{/user/__*{uuid}__/edit}"
									class="btn btn-sm btn-warning"
									th:text="${#messages.msg('label.button.edit')}">Edit</a>
								<button
									th:if="${action=='view' and @appsUtil.getActiveUserUuid()!=user.uuid}"
									class="btn btn-sm btn-danger" type="button"
									th:text="${#messages.msg('label.button.delete')}"
									data-toggle="modal" data-target="#modal-delete-user">Delete</button>
								<button th:if="${action=='edit' or action=='add'}"
									class="btn btn-sm btn-success" type="submit"
									th:text="${#messages.msg('label.button.save')}">Save</button>
								<button th:if="${action=='edit' or action=='add'}"
									class="btn btn-sm btn-danger" type="reset"
									th:text="${#messages.msg('label.button.reset')}">Reset</button>


							</form>
						</section>
					</div>
				</div>

				<div
					th:if="${action=='view' and @appsUtil.getActiveUserUuid()!=user.uuid}"
					class="modal fade" id="modal-delete-user" tabindex="-1"
					role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<form th:action="@{/user/__${user.uuid}__/delete}" method="POST">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
									<h4 class="modal-title"
										th:text="${#messages.msg('message.delete')}">Are you sure
										want to delete this data?</h4>
								</div>
								<div class="modal-footer">
									<input type="hidden" th:name="${_csrf.parameterName}"
										th:value="${_csrf.token}" />
									<button type="button" class="btn btn-default"
										data-dismiss="modal"
										th:text="${#messages.msg('label.button.close')}">Close</button>
									<button type="submit" class="btn btn-danger"
										th:text="${#messages.msg('label.button.delete')}">Delete</button>
								</div>
							</div>
						</div>
					</form>
				</div>

				<div id="popup" class="popup" style="display: none;">
					<div class="popup__body">
						<div class="js-img"></div>
					</div>
					<div style="margin: 0 0 5px; text-align: center;">
						<div class="js-upload btn btn-small btn-success">Upload</div>
						<div class="js-cancel btn btn-small btn-warning">Cancel</div>
					</div>
				</div>

			</div>
		</div>
	</div>

	<!-- /#page-wrapper -->
	<!-- /#wrapper -->
	<div th:replace="base::js-core"></div>
	<script th:src="@{/vendor/duallistbox/jquery.bootstrap-duallistbox.js}"
		src="../static/vendor/duallistbox/jquery.bootstrap-duallistbox.js"></script>

	<script type="text/javascript">
		/*<![CDATA[*/

		jQuery(document).ready(
				function() {
					jQuery("span.timeago").timeago();
					setTimeout(function() {
						$(".alert").alert('close');
					}, 8000);

					$("#roleNames").bootstrapDualListbox({
						bootstrap2Compatible : false,
						moveAllLabel : 'MOVE ALL',
						removeAllLabel : 'REMOVE ALL',
						filterPlaceHolder : 'FILTER',
						filterSelected : '2',
						filterNonSelected : '1',
						moveOnSelect : true,
						preserveSelectionOnMove : 'all',
						helperSelectNamePostfix : '_myhelper',
						selectedListLabel : 'Selected',
						nonSelectedListLabel : 'Unselected'
					}).bootstrapDualListbox('setMoveAllLabel',
							'Move all elements').bootstrapDualListbox(
							'setRemoveAllLabel', 'Remove all elements')
							.bootstrapDualListbox('setSelectedFilter',
									undefined).bootstrapDualListbox(
									'setNonSelectedFilter', undefined)
							.bootstrapDualListbox('refresh')

					$('#docstores').bootstrapDualListbox({
						bootstrap2Compatible : false,
						moveAllLabel : 'MOVE ALL',
						removeAllLabel : 'REMOVE ALL',
						filterPlaceHolder : 'FILTER',
						filterSelected : '2',
						filterNonSelected : '1',
						moveOnSelect : true,
						preserveSelectionOnMove : 'all',
						helperSelectNamePostfix : '_myhelper',
						selectedListLabel : 'Selected',
						nonSelectedListLabel : 'Unselected'
					}).bootstrapDualListbox('setMoveAllLabel',
							'Move all elements').bootstrapDualListbox(
							'setRemoveAllLabel', 'Remove all elements')
							.bootstrapDualListbox('setSelectedFilter',
									undefined).bootstrapDualListbox(
									'setNonSelectedFilter', undefined)
							.bootstrapDualListbox('refresh')

				});
		/*]]>*/
	</script>
</body>
</html>

