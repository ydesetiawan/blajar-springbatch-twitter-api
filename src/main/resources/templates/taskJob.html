<!DOCTYPE html>
<!--/* Copyright (C) 2014 ASYX International B.V. All rights reserved. */-->
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title
	th:text="${@environment.getProperty('application_name')} + ' - ' + ${#messages.msg('label.task.title')}">Task
	Details</title>
<link rel="stylesheet" th:if="${#themes.code('name')==''}"
	th:href="@{'/css/default-master.css'}" />
<link rel="stylesheet" th:if="${#themes.code('name')!=''}"
	th:href="@{'/css/' + ${#themes.code('name')} + '-master.css'}" />
</head>
<body
	th:class="${#themes.code('skin')+(@xchange3Util.fetchCookie(#httpServletRequest.cookies, 'minifyMenu')!=null?' minified':'')}"
	th:classappend="${#authentication.principal.perspective}">
	<div th:replace="layout-dashboard :: header-panel"></div>
	<div th:replace="layout-dashboard :: left-panel"></div>
	<div id="main" role="main">
		<div th:replace="layout-dashboard :: default-ribbon"></div>

		<div id="content">
			<section>
				<h1 th:text="${#messages.msg('label.task.title')}">Task Details</h1>
				<div th:if="${alertSuccess}" class="alert alert-success fade in">
					<a href="#" class="close" data-dismiss="alert">&times;</a><span
						th:text="${alertSuccess}">Success message.</span>
				</div>
				<div th:if="${alertWarning}" class="alert alert-warning fade in">
					<a href="#" class="close" data-dismiss="alert">&times;</a><span
						th:text="${alertWarning}">Warning message.</span>
				</div>
				<form class="form" action="/task" method="POST">
					<div th:if="${result!=null AND result.hasErrors()}"
						class="alert alert-warning fade in">
						<ul>
							<li th:each="err : ${result.allErrors}"
								th:text="${err.defaultMessage}">Input is incorrect</li>
						</ul>
					</div>
					<input type="hidden" th:name="${_csrf.parameterName}"
						th:value="${_csrf.token}" /> <input type="hidden"
						th:name="taskId" th:value="${task.id}" /> <input type="hidden"
						th:name="form_document" th:value="${form_document}" /><input
						type="hidden" th:name="action" th:value="'update'" />
					<table class="table">
						<thead>
							<tr>
								<th th:text="${#messages.msg('label.key')}">Key</th>
								<th th:text="${#messages.msg('label.value')}">Value</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td th:text="${#messages.msg('label.tasks.businessKey')}">Business
									Key</td>
								<td th:text="${businessKey}">task_key</td>
							</tr>
							<tr>
								<td th:text="${#messages.msg('label.tasks.name')}">Name</td>
								<td th:text="${task.name}">task_name</td>
							</tr>
							<tr>
								<td th:text="${#messages.msg('label.tasks.created')}">Created</td>
								<td><span th:if="${@xchange3Util.showRelativeTime}"
									class="timeago"
									th:title="${@documentController.getIso8601DateFormat(task.createTime)}"
									th:text="${task.createTime}"></span><span
									th:if="${!@xchange3Util.showRelativeTime}"
									th:text="${#calendars.format(task.createTime,'dd MMM yyyy HH:mm')}"></span></td>
							</tr>
							<tr>
								<td th:text="${#messages.msg('label.tasks.action')}">Action</td>
								<td><a th:unless="${action}=='edit' or ${task_actions}"
									class="btn btn-xs btn-primary"
									th:href="${completeRedirect != null} ? @{/task/__${task.id}__/complete(redirect=${completeRedirect})} : @{/task/__${task.id}__/complete}"
									href="#"><span class="glyphicon glyphicon-check"></span> <span
										th:text="${#messages.msg('label.button.complete')}">Complete</span></a>
									<span th:each="task_action : ${task_actions}"
									th:switch="${task_action.key}"> <a th:case="'accept'"
										th:unless="${action}=='edit'" class="btn btn-xs btn-success"
										th:href="${acceptRedirect != null} ? @{/task/__${task.id}__/__${task_action.key}__(redirect=${acceptRedirect})} : @{/task/__${task.id}__/__${task_action.key}__}"
										href="#"><span class="glyphicon glyphicon-ok-sign"></span>
											<span th:text="${task_action.value}">Action</span></a><a
										th:case="'reject'" th:unless="${action}=='edit'"
										class="btn btn-xs btn-danger"
										th:href="${rejectRedirect != null} ? @{/task/__${task.id}__/__${task_action.key}__(redirect=${rejectRedirect})} : @{/task/__${task.id}__/__${task_action.key}__}"
										href="#"><span class="glyphicon glyphicon-remove-sign"></span>
											<span th:text="${task_action.value}">Action</span></a> <a
										th:case="'cancel'" th:unless="${action}=='edit'"
										class="btn btn-xs btn-danger"
										th:href="@{/task/__${task.id}__/__${task_action.key}__}"
										href="#"><span class="glyphicon glyphicon-check"></span> <span
											th:text="${task_action.value}">Cancel</span></a><a th:case="*"
										th:unless="${action}=='edit'" class="btn btn-xs btn-primary"
										th:href="@{/task/__${task.id}__/__${task_action.key}__}"
										href="#"><span class="glyphicon glyphicon-check"></span> <span
											th:text="${task_action.value}">Complete</span></a>
								</span> <a th:unless="${action}=='edit'" th:if="${form_editable}"
									class="btn btn-xs btn-warning"
									th:href="@{/task/__${task.id}__/edit}" href="#"><span
										class="glyphicon glyphicon-edit"></span> <span
										th:text="${#messages.msg('label.button.edit')}">Edit</span></a>
									<button type="submit" th:if="${action}=='edit'"
										class="btn btn-xs btn-success">
										<span class="glyphicon glyphicon-floppy-save"></span> <span
											th:text="${#messages.msg('label.button.save')}">Save</span>
									</button>
									<button type="reset" th:if="${action}=='edit'"
										class="btn btn-xs btn-danger">
										<span class="glyphicon glyphicon-floppy-remove"></span> <span
											th:text="${#messages.msg('label.button.clear')}">Clear</span>
									</button></td>
							</tr>
						</tbody>
					</table>

					<div class="panel panel-default">
						<div class="panel-body">
							<h2 th:text="${#messages.msg({form_key}+'_long')}">Document
								Content</h2>
							<div
								th:include="@{http://taskjob(id=${jobId})}">
								<span th:text="${#messages.msg('label.task.notAvaliable')}">Not
									available</span>
							</div>
						</div>
					</div>
				</form>
			</section>
		</div>
	</div>

	<div th:replace="layout-dashboard :: footer-panel"></div>
	<div th:replace="layout-dashboard :: shortcut-panel"></div>
	<div th:replace="base :: scripts"></div>
	<script th:inline="javascript">
		/*<![CDATA[*/
		jQuery(document).ready(function() {
			//var url = /*[[@{/task/__${jobId}__/getMessage}]]*/null;
			//$.get(url, function(data) {
			//	$("#parserMessage").html(data);
			//});
			jQuery("span.timeago").timeago();
			(window.formDocumentReady || function() {
			})();
			setTimeout(function() {
				$(".alert").alert('close');
			}, 8000);
		});
		$("ul#menu-list li#tasks-list").addClass("active");
		/*]]>*/
	</script>

	<div th:replace="base :: script-google-analytics"></div>
</body>
</html>